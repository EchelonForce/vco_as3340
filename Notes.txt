Issues on v1
 - When making the front panel drawings I noticed the fine tune pot and PWM pot are not equally spaced from the center line. Also the jacks centers are not equidistant from the sides making front panel layout awkward. I made the whole PCB off center relative to the front panel to mitigate this.

 - Fought the output of the pulse wave a lot. There was a lot of ringing on the falling edge. I found some info online https://lookmumnocomputer.discourse.group/t/glitches-or-ringing-on-the-pulse-output-of-the-as3340-and-cem3340/752/5
that suggests using a 10M between the PWM an Pulse pins. I tried that and a few other values but still had issues. I also tried a few small cap values trying to filter the pulse output. Eventually I probed the -5V supply at the chip and found significant ripple in that supply. When I removed the chip (no load) the ripple went away, so I patched in more capacitance at the JP3 jumper (10uF polarized) and that cleaned up the wave considerably. There was still some ring in the pulse output after the buffer that wasn't there pre-buffer (see notes later about scope probe). I removed R6 to help with that. R6 was meant to be a pulldown for the buffer input that I've used in other designs but here it interfered with the R7/R8 voltage divider causing lower than expected output.

- After building 4 of these (intending to test different caps) I have had issues with tuning accross all of them so I pulled them out of the rack and started debugging that. First I started by retrimming everything. I suspect I was impatient after building them because all of them needed adjustment. I powered them all on togeth and let them sit about an hour and then trimmed RZ_TEMP1 again and waited another half hour or so. Then went about the tuning by shorting JP4 and tuning to C6. I found while doing this that tuning one vco against another was easier than tuning to 1046.5 on my scope. The wave forms slide in and out of phase visually on screen and I can get them very close by bringing the slide to a stop but it's fiddely, they never really stop for long. I finished with unshorting and refinding C6 with the 5V CV and C1 with the 0V CV (again tuning with visually helped).

- After all that I let the run for a while and came back to check the pulse wave again and on one it was pretty ringy on the falling edge but only below 5V CV... so I googled again and found this thread
https://modwiggler.com/forum/viewtopic.php?t=231130
That led me to retry a 10M 'hysteresis' resistance between pins 4 and 5, which again didn't work. Strangely if I probed from pin 4 directly the output would be quite a bit better, but a pretty long flank on the falling edge, I guess the scope probe impedance/capacitance was effecting it a lot...On the same thread others mentioned a pull down cap on pin 4 and this improved things significantly. I landed on 100pF after trying large and smaller common values. Unlike the smoothing cap added to the -5V rail earlier, I don't have a nice place to rework this cap to the boards. 

So now there's finally a pretty clean pulse across the 0V-10V range

Current state: 2022-08-23 - See phone photo
 - R10 is 47k
 - 100pF across R10
 - R9 short
 - JP3 10uF polarized cap from -5 to -12 rail. 
 - JP2 short
 - R5 short
 - R6 DNU
 - JP1 short
 - Unit 1 & 2 - red caps
 - Unit 3 - white cap
 - Unit 4 - poly cap
 - R21 & R23 are 5.1k
 - RZ1 18k not 13k

Some other things to investigate.
 - try running on batteries to see if it cleans up frequency meandering? measure first.
 - buy and try higher precision resistors R30, R2,
 - I haven't messed with high freq. track at all yet.
 - Need to do more thorough look at tracking in general from 0-10V.
 - Fine tune knob has a little too much influence on tune, several semi tones... reduce?
   - Increase R3 or reduce range of RFINE_TUNE1
 - Try 5.6k on R21,R23 to reduce component count.

2022-08-28 - Testing Notes
Did a bunch of testing with the frequency counter. 
Completely retuned all four DUTs with frequency counter and mV scale for temp adjust step 1.
The tracking from 0v to 5V looked pretty good using a bench supply for CV and multimeter with mV accuracy. Frequency counter struggled a bit at some frequencies, compared against oscilliscope at lower frequencies.
  Procedure was:
   Powered on for 1hr or more to warm up.
   Readjusted temp1 w/ mV range on multimeter, drifts a bit, got it under a mV.
   Short J4 and get 1046.5 with ref pitch.
   Set Fine Tune knob to center.
   Set Freq knob to 0, full CCW.
   Input CV 5.000V+-0.001
   Use Refind C6 to get 1046.5, this was trickier than with F4 shorted.
   Input CV 0.000V+-0.001
   Use scale adjust to get 32.70+/-0.01 Hz 
   Checked tracking.

 V    Unit   
        1      2       3        4    Ideal
0V    32.7    32.7    32.7    32.7   32.7
1V    65.45   64.9    66.0    66.0   65.41
2V   130.9   130.2   130.7   130.6   130.81
3V   261.9   260.8   261.8   261.4   261.63
4V   523.3   521.6   523.4   522.5   523.25
5V   1047    1045    1049    1046    1046.5

So nearly all within a 1Hz of ideal. 

At this point I checked the weird result the tuner gives me at 1046 with a signal from the frequency gen. I was weird there too and I will investigate that later.

Then I went into trying the DUTs with the midi cv. Unfortunately that also has and issue so the impedance of the oscillators effect it's output. Details in that other note sheet...ugh. 

After some fiddling with the midicv, I thought I had it generating accurate voltages. Unfortunately because the oscillators were tuned with a strong voltage source they didn't behave. All of them need to be offset with the knob :( I want to avoid that, but I guess I have to tune them with the midi source instead??? Kind of confused about this. They seem to work okay with manual tune.

Maybe I just need to redo the circuit and accept the harder tuning method...or maybe is psu voltage differences.
Starting to think a digital oscillator would be so much easier.

2022-09-04
Did some more rigid testing of the AI011 and DUT2. See testing folder notes. 




Schematic Changes v1 to v2:
 - R10 = 47k
 - R9 = 0ohm 
 - New C1 100pF across R10 and R9
 - New C15 10uF polarized cap from -5 to GND. 
 - R6 DNU
 - R21 & R23 changed to 5.1k 
 - RZ1 changed to 18k
 - R26 changed to 100k and new R31 is 100k.
 - New  R32 for 'hysteresis' between PWM and Pulse.
 - Separated grounds on Linear FM and Scale Adj. Circuits for clarity.
 - Added another TL072 (U6) and supporting circuits.
    - This is intended to supply two reference voltages from the 5V source.
    - The idea is to provide Soft Sync (pin 9) with a stable voltage of 1/3*Supply, which is something like 11.3/3.
    - The other REF_PITCH1 is for the Linear FM circuit. Some resistors probably aren't right for this yet, replaced original ref_pitch with this.
  Moved outputs to a tl074 to save some space.
  Removed jp1,2,3 and extra vee stuff, just going to use -5V ref.
  Added second frequency CV jack.

Other 
 - During assembly, short J1 and J2

Sim of virtual ground summing node on CVs
https://tinyurl.com/29nqo2se

https://www.eddybergman.com/2020/01/synthesizer-build-part-18-really-good.html





---------------------------------------------------------------------------------
Issues on v2 PCB:
 - VEE net isn't connected to -5V so the scale adjust circuit isn't powered. Rework short from C10 to RT1.
 - 10pF cap needed on Sawtooth first stage opamp. There was ring in this on the falling edge and this cap helped. (between U4's pins 8/9)
 - Rr1 was changed to 220k from 330k.
 - R4, R33 and R34 should be 100k.
 - C19 should be DNU, it caused oscillation on REF_VOLT_1.
 - Add 10pF on U4B (between pins 6/7) for rising edge of pulse.
 - Add resistors for PWM pot so it's range is limited. (also do fine tune if there's room).
 - Add cal frequencies on silkscreen if there's room.
 - Change supply into REFIND_C6, from 12V to REF_PITCH_1.
 - Change R21 to 10k
 - Change R23 to 0Ohm
 - Change R8 to 110k, lowers pulse out peak to peak.
 
Issues on v2 Front Panel
 - Tried to have holes for the trim pots that are technically on the back of the PCB so they could be mounted on the front, but the holes in the panel are oriented for when the pots are on the back. Need to move them.
 - Trim pot holes could be smaller.
 - Saw wave has rising edge, but it should be falling (rising slope).

Test Notes 2022-12-26:
 - Assembled 2 PCBs.
 - Checked voltage rails +/- 12V, +/- 5V
 - Before adding the AS3340, set the REF_VOLT_1 to 1/3 Vcc = 3.75V
    - I checked REF_VOLT_1 with multimeter (TP3) but that hid the oscillations (almost full peak to peak). Eventually I figure that out with a scope and removed C19 and changed REF_VOLT_1 op-amp resistors for non-unity gain.
 - Add the AS3340.
 - Tried an output and there was no frequency change when the knobs were used...
 - Tried cal step 1 (temp adjust) but the diff between TP1/2 was exactly 0.
 - Debugged this until I figured out the missing VEE net to -5V connection. Fixed with short between C10 and RT1.
 - Checked the other outputs. Sawtooth had bad ring in it the AS3340 output was clean, so I added a 10pF on the first stage opamp feedback which improved it considerably.
 - Did Cal step 1, okay.
 - During Cal step 2 I couldn't get C6 on the output, it was close, so I looked at the new REF_PITCH voltage reference, it was maxing out at ~10V from the opamp, since it can't go any higher I changed Rr1 from 330k to 220k and that was just enough head room. Might need even lower to allow lower input voltages.
 - Checked Fine Tune range. Seems to be +/-2 semi-tones (at 5V on freq CV) which I think is okay.
 - Measured the triangle wave symmetry with scope cursors. Seems perfect at 5V on freq CV. 

Test Notes 2023-01-07:
 - Checked PWM knob range. It goes to 100% Duty too early @ 3.9V. 
  - Need to add a couple resistors inline with the pot to adjust it to the useful range.
 - Recorded some frequency data while adjusting the Vcc from 11.9V up to 12.1V. 
  - The frequency change (starting with 1000Hz at 12V) was 50Hz over the 0.2V range tested. 
    - Also tested a v1.0PCB and the result was similar. This is about 25% per Volt.
  - I think it's due to the REFIND_C6 supply voltage varying.
 - Checked Square wave peak to peak, it's about 11V. And there's a bi of ring on the rising edge.
  - Made R8 = 110k to lower the output closer to 10V.
  - Added a 10pF cap on top of R27 to help the ring. (took photos).
 - Tested the PWM effect on frequency with and without the R32 populated (2.2MOhm and open).
  - No significant difference. Tested 5% increments at a 1000Hz starting point, in both cases, aout 6Hz change over full PWM range.

Test Notes 2023-01-08:
 - Tried to fix the supply voltage into REFIND_C6. cut the 12V trace and wired it to TP4 (REF_PITCH1).
  - Checked REF_PITCH1 with scope after rework to make sure it was stable still.
  - After this tried several Vcc voltages and it's much improved, At 1000Hz @ 12V, 998 @ 12.25V and 1004 @ 11.75V. So about 6Hz over 0.5V. This is about 1.2% per Volt. That's way better than yesterday's test w/o this. Through test REF_PITCH1 was rock solid 9.727V (set from cal steps).

Old Todos:
 - Test CV to freq scaling more throughly.
    - Done.
 - Test freq/pwm shift and try the 'hysteresis' resistor R32.
    - Done.
 - Test with different supply voltages to see if the behavior is better.
    - Done. It's about the same as v1.0 until I reworked REFIND_C6 supply.

 - Tested the HF Track adjustment. At 10V CV the pot couldn't reach an adequate setting for 33488Hz.
 - Decided to measure the voltage (and therefor current) of the HF Track pin. At 10V CV, the HF pin over the 20200k combined resistance, the voltage was 1.331V (also tested other CVs). So there's about 65uA out of the HF pin. Instead of risk a bunch of other issues, swapped the resistors but kept the overall resistance nearly the same.
  - Removed both 5.1k R21/R23. R21 was changed to 10k, R23 was shorted. This put the trim pot in the area need to trim out the tracking error at 10V CV.
  - Re-tested tracking from 0 to 10V CV. All good: https://docs.google.com/spreadsheets/d/1qfa5OgiflcCrpyueND8rxWKN7h0p5OLnycMwUe4vgko/edit?usp=sharing
 - Did all reworks to DUT2 and calibrated it. Seems okay.


Test Notes 2023-01-09:
 - Checked Sync input. Seems okay on hard sync. Requires hard edges like VCO pulse, soft edges don't work. 
    - Switch is not really useful with REF_VOLT and JP5. Added JP1 so that switch can function as a sync enable/disable.
 - Updated PCB and Schematic with all changes in redlined pdf of v2.
